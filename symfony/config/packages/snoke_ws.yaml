snoke_ws:
  mode: '%env(resolve:default::WS_MODE)%'
  transport:
    type: '%env(resolve:default::WS_TRANSPORT_TYPE)%'
    http:
      base_url: '%env(resolve:default::WS_GATEWAY_BASE_URL)%'
      publish_path: '/internal/publish'
      timeout_seconds: 5
      auth:
        type: api_key
        header: 'X-Api-Key'
        value: '%env(resolve:default::WS_GATEWAY_API_KEY)%'
    redis_stream:
      dsn: '%env(resolve:default::WS_REDIS_DSN)%'
      stream: '%env(resolve:default::WS_REDIS_STREAM)%'
    rabbitmq:
      dsn: '%env(resolve:default::WS_RABBITMQ_DSN)%'
      exchange: '%env(resolve:default::WS_RABBITMQ_EXCHANGE)%'
      queue: '%env(resolve:default::WS_RABBITMQ_QUEUE)%'
      routing_key: '%env(resolve:default::WS_RABBITMQ_ROUTING_KEY)%'
  presence:
    type: '%env(resolve:default::WS_PRESENCE_TYPE)%'
    http:
      base_url: '%env(resolve:default::WS_GATEWAY_BASE_URL)%'
      list_path: '/internal/connections'
      by_user_path: '/internal/users/{user_id}/connections'
      timeout_seconds: 5
    redis:
      dsn: '%env(resolve:default::WS_REDIS_DSN)%'
      prefix: '%env(resolve:default::WS_REDIS_PREFIX)%'
    interpretation:
      strategy: '%env(resolve:default::WS_PRESENCE_INTERPRETATION_STRATEGY)%'
      ttl_seconds: '%env(int:default::WS_PRESENCE_TTL_SECONDS)%'
      heartbeat_seconds: '%env(int:default::WS_PRESENCE_HEARTBEAT_SECONDS)%'
      grace_seconds: '%env(int:default::WS_PRESENCE_GRACE_SECONDS)%'
      use_last_seen: '%env(bool:default::WS_PRESENCE_USE_LAST_SEEN)%'
    writer:
      type: '%env(resolve:default::WS_PRESENCE_WRITER_TYPE)%'
      ttl_seconds: '%env(int:default::WS_PRESENCE_WRITER_TTL_SECONDS)%'
      refresh_on_message: '%env(bool:default::WS_PRESENCE_WRITER_REFRESH_ON_MESSAGE)%'
  events:
    type: '%env(resolve:default::WS_EVENTS_TYPE)%'
    webhook:
      path: '/internal/ws/events'
      enabled: true
    redis_stream:
      dsn: '%env(resolve:default::WS_REDIS_DSN)%'
      stream: '%env(resolve:default::WS_REDIS_EVENTS_STREAM)%'
    rabbitmq:
      dsn: '%env(resolve:default::WS_RABBITMQ_DSN)%'
      exchange: '%env(resolve:default::WS_RABBITMQ_EVENTS_EXCHANGE)%'
      queue: '%env(resolve:default::WS_RABBITMQ_EVENTS_QUEUE)%'
      routing_key: '%env(resolve:default::WS_RABBITMQ_EVENTS_ROUTING_KEY)%'
  subjects:
    user_prefix: 'user:'
